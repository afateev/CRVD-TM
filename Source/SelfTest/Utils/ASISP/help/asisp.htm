<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title>AS3-help</title>
</head>
<body style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);"
 link="#0000ff" vlink="#800080">
<center><big><big><span style="font-weight: bold;">Программа ASISP </span></big></big><br>
</center>
<ul>
</center>
<span style="font-weight: bold;">Внимание! Необходимо при использовании
программатора соединить общий провод платы
с программируеммым микроконтроллером, с корпусом компьютера, к которому
подключен программатор! Несоблюдение этого правила ведет к повреждению
программатора при коммутации программирующего кабеля.
</span><br><br>
Программа ASISP функционирует в среде Windows 98/2000/XP и
предназначена для совместной работы с программаторами AS2M и AS3.
Обеспечивается программирование микроконтроллеров серий
AТmega/AТtiny/AT89S/AT90 и микросхем памяти серий&nbsp; AT25 и
AT45 фирмы ATMEL. Программа имеет русско- и
англоязычный интерфейс. Выбор языка производится установкой
соответствующей опции в любой момент времени. <br>
Программа имеет графический пользовательский интерфейс, также
предусмотрена возможность вызова программы из командной строки.<br>
  <br>
  <br>
  <br>
  <center style="font-weight: bold;"><big>Описание команд программы
ASISP<br>
  </big></center>
  <br>
Программа имеет интуитивно понятный интерфейс. Основные команды
вынесены в главное окно, и доступ к ним осуществляется одним нажатием
кнопки мыши или комбинацией клавиш на клавиатуре. Главное окно содержит
следующие элементы: <br>
  <ul>
    <li>панель «ниспадающих» меню для работы с файлами и настройками; </li>
    <li>поле просмотра содержимого файла ПЗУ программы,
предназначенного
для загрузки в микроконтроллер, либо содержимого ПЗУ, считанного из
микроконтроллера; </li>
    <li>поле с указанием имени файла ПЗУ программы; </li>
    <li>поле просмотра содержимого файла ЭСПЗУ, предназначенного для
загрузки в микроконтроллер, либо содержимого ЭСПЗУ, считанного из
микроконтроллера; </li>
    <li>поле с указанием имени файла ЭСПЗУ; </li>
    <li>поле с названием типа программируемой микросхемы; </li>
    <li>группа клавиш «быстрого доступа»; </li>
    <li>строка сообщений; </li>
    <li>строка с указанием текущих установок. </li>
  </ul>
  <p style="text-align: center;"><span style="font-weight: bold;">Внешний
вид главного окна программы ASISP</span><br>
  </p>
  <p align="center"><span style="text-decoration: underline;"><a
 href="Hardware/AS3/help/"><img alt="asisp_main" src="asisp_main.jpg"
 style="border: 0px solid ; width: 680px; height: 480px;"></a></span><br>
  </p>
Процесс программирования осуществляется нажатием соответствующих
клавиш. Если микросхема ранее содержала какую-либо информацию, или у
нее были установлены биты защиты, микросхему необходимо предварительно
стереть.
  <center>
  <h3>Панель меню</h3>
  </center>
Меню <b>Проект (Project)</b> — создание, загрузка, сохранение проекта;<br>
Меню <b>Flash</b> — операции с файлами, содержащими информацию о ПЗУ
программ;<br>
Меню <b>Eeprom</b> — операции с файлами, содержащими информацию о ПЗУ
данных;<br>
Меню <b>Настройки (Settings)</b> — вызов меню настроек;<br>
Меню <b>Дополнительно (Advanced)</b> — вызов окна команд;<br>
Меню <b>Помощь (Help)</b> — вызов окна помощи ( в формате HTML).
  <center>
  <h3>Работа с проектом</h3>
  </center>
  <p>Для удобства работы с различными типами микросхем опции
программирования рекомендуется использовать файл проекта. Файлов
проектов может быть несколько, таким образом осуществляется легкий
переход к программированию микросхемы другого типа. Текущий тип
микросхемы индицируется в соответствующем окне программы. Для
AVR-микроконтроллеров тип
микросхемы также может быть определен автоматически — для этого нужно
выполнить команду чтения сигнатуры. Для работы с
остальными микросхемами&nbsp; тип
микросхемы необходимо установить вручную. Затем можно производить любые
операции с файлами, памятью
микроконтроллера и его битами защиты. Все настройки для
программирования - имена файлов, пути к файлам и тип микросхемы -
сохранятся в файле
проекта. Последний проект автоматически открывается при последующем
запуске.<br>
  </p>
  <p style="text-align: center;"><b>Внешний вид окна Project Settings</b>
  <br>
  </p>
</ul>
<div style="text-align: center;"><img alt="asisp_project_settings"
 src="asisp_project_settings.jpg" style="width: 669px; height: 404px;"><br>
</div>
<ul>
  <p>Для прошивки микросхем программа ASISP использует один из двух
алгоритмов: стандартный и ускоренный (data polling). Стандартный
алгоритм подразумевает достаточно большое фиксированное время для
прошивки каждого байта, соответственно общая скорость прошивки не очень
высокая. При ускоренном алгоритме (опция Enable data polling включена)
производится опрос каждого запрограммированного байта и, в случае
подтверждения окончания програмирования, программа переходит к
следующему адресу. Так как реальное время программирования конкретного
байта часто оказывается меньше указанного в технических условиях на
микросхему, общая скорость программирования повышается. </p>
  <p>Опция выбора частоты задающего генератора управляет длительностью
импульса SCK в микросекундах при обмене данными между программируемым
микроконтроллером и программатором. Для работы с микроконтроллерами
семейства AT90S/ATtiny/ATmega частота программирующих импульсов SCK
должна быть не менее, чем в четыре раза ниже частоты задающего
генератора, для AT89S51, AT89S52 и AT89S8252&nbsp; — не менее, чем в 16
раз, а для
AT89S8252 и AT89S53 — не менее, чем в 40 раз ниже частоты задающего
генератора программируемого микроконтроллера. </p>
  <p>Программа ASISP позволяет загружать два файла как в окно памяти
программ, так и в окно памяти данных. По команде: FLASH/открыть по
адресу/ (FLASH/load At) или EEPROM/открыть по адресу/ (EEPROM/Load At)
можно загружать, например, заранее подготовленные фрагменты кода в
заданную область памяти программ или памяти данных без дополнительной
компиляции. Эта опция также очень удобна для размещения таблиц данных
или наборов параметров по верхним адресам FLASH или EEPROM.<br>
  </p>
  <p>Файл проекта - это текстовый файл, который доступкн для просмотра
и редактирования.<br>
  </p>
  <center>
  <h3>Автоинкремент</h3>
  </center>
Эта опция предназначена для автоматической записи серийного номера
изделия в FLASH или EEPROM. Для этого в соответствующей строке
вписывается шестнадцатеричный адрес. При активации режима
«Автоинкремент» программа считает поле слева от введенного адреса
полем, в котором будет располагаться 4—байтный серийный номер. При
этом, после окончания программирования, будет произведен инкремент
этого 4—байтного числа с учетом переноса.
  <p><b>Пример:</b> <br>
- в поле EEPROM основного окна по адресам 04, 05, 06 и 07 записывается
число 12 34 56 78 (серийный номер);<br>
- в строке Eeprom(HEX) окна Settings вводится адрес 07 и активируется
опция «Автоинкремент»;<br>
- производится программирование микросхемы. </p>
  <p>После окончания программирования серийный номер примет следующее
значение: 12 34 56 79. При размещении серийного номера в пространстве
FLASH памяти микроконтроллера необходимо на этапе создания исходного
кода программы зарезервировать необходимое пространство. </p>
  <center>
  <h3>Функция автопрограммирования</h3>
  </center>
  <p>В проекте также можно сохранить опции автопрограммирования
(стирание, перезагрузка / программирование / проверка файлов, биты
защиты, FUSE—биты, автоинкремент FLASH и EEPROM) и пользоваться данной
функцией нажатием кнопки Auto—program в главном окне.<br>
  </p>
</ul>
<ul>
Окно Lock &amp; Fuse bits setting содержит строки для программирования
Lock— Fuse битов. Набор этих битов отличается у разных микросхем.
Опции, установленные в данном окне, действуют на протяжении текущего
сеанса работы с программатором AS2/AS3. Чтобы сохранить выбранные опции
для следующих сеансов работы, нужно выполнить команду "Сохранить
проект".
  <p align="center"><b>Внешний вид окна Lock &amp; Fuse bits</b> <br>
  <br>
  <img alt="asisp_fuses" src="asisp_fuses.jpg"
 style="width: 564px; height: 416px;"></p>
  <p><br>
Окно Board setting — выбор COM-порта и настройка скорости обмена
программатора AS2/AS3 с компьютером. Поддерживается работа с восемью
СОМ-портами компьютера. Программатор AS2M можно подключать к компьютеру
через конвертор интерфейса USB-COM. <br>
Программатор AS23 подключается&nbsp; к USB-порту компьютера.
Эмулятор СОМ-порта находится непоспедственно в программаторе. Обычно
эмулируется
COM-порт с номером от 3 до 8. Возможно одновременное подключение
нескольких программаторов AS2/AS3 к одному компьютеру. При этом, с
каждым
экземпляром программатора AS2/AS3 будет работать отдельная прграмма
ASISP.
Эта возможность позволяет ускорить процесс программирования партии
микроконтроллеров на одном компьютере.</p>
  <p>На «медленных» компьютерах может не хватить ресурсов для
обслуживания COM-порта на стандартной или высокой скорости, вследствие
чего возможно
нарушение синхронизации. В таких случаях&nbsp;
рекомендуется выбрать медленную скорость. </p>
  <p align="center"><b>Внешний вид окна Board Settings</b> <br>
  <br>
  </p>
</ul>
<div style="text-align: center;"><a
 href="Hardware/AS3/Board_settings.jpg"><img alt="ASISP_board_settings"
 src="ASISP_board_settings.jpg"
 style="border: 0px solid ; width: 324px; height: 302px;"></a><br>
</div>
<ul>
  <center>
  <h3>Меню Advanced</h3>
  </center>
  <p>Здесь собраны команды, позволяющие прочитать информацию о
программируемой микросхеме и собственно программаторе. </p>
  <p><b>Проверка на чистоту (Empty check)</b> — проверка
программируемого
микроконтроллера на «чистоту».<br>
  <b>Чтение сигнатуры (Read signature)</b> — команда считывает
сигнатуру
программируемого микроконтроллера, может использоваться для контроля
правильности подключения ISP—разъема к программируемой микросхеме.<br>
  <b>Чтение калибровочных байтов (Read Calibration bytes)</b> - чтение
калибровочных байтов (в микросхемах, которые имеют эту опцию)<br>
  <b>Обновить версию платы (Update firmware version) </b>- обновление
прошивки микроконтроллера ATmega8L программатора AS2/AS3<br>
  <b>Поиск платы (Search board)</b> — поиск платы программатор AS2M/AS3
путем
поочередного опроса COM—портов компьютера.<br>
  <b>AS2M/AS3 Info</b> — отображение версии программы (firmware),
зашитой в
микроконтроллер программатора AS2M/AS3. Может использоваться для
проверки
функционирования программатора.<br>
  </p>
  <center>
  <h3>Настройки программатора AS2M/AS3</h3>
  </center>
  <p>При первом запуске программы ASISP выводится окно, где надо
выбрать
номер последовательного порта компьютера, к которому подключена плата
AS2M/AS3, и установить скорость обмена, низкую, стандартную или
высокую. В первом случае обмен происходит на скрости 19,2 Кбод, во
втором случае - на скорости 115,2 Кбод. При выборе высокой скорости
обмена программатор AS3 использует скорость 921,6 Кбод, а программатор
115,2 Кбод, так как эта скорость является для AS2M максимальной. Эти
параметры записываются в .ini файл, который хранится в каталоге
Windows. Окно можно также вызвать из меню (Advanced—&gt;Board
Settings…). Если сделать автопоиск всех подключенных устройств AS2M/AS3
(Advanced—&gt;Search board), программа проверит все COM-порты и выведет
аппаратные версии плат AS2M/AS3 на каждом из них. Автоматически будет
активизирована первая плата (на порте с меньшим номером). Таким
образом, можно работать с несколькими платами AS2M/AS3 на одном
компьютере.
Номер текущего COM-порта и скорость обмена отображаются в окошке правее
статуса. Установленные настройки платы действуют для всех проектов.<br>
  </p>
  <h3 style="text-align: center;">Обновление прошивки программатора
AS2M/AS3</h3>
  <p>Корпорация ATMEL систематически выпускает новые модели
микроконтроллеров,
соответственно, программа ASISP регулярно обновляется. В новых версиях
расширяется список поддерживаемых микроконтроллеров. Последнюю версию
программы ASISP можно переписать отсюда: <a
 href="http://atmel.argussoft.ru">http://atmel.argussoft.ru/as3.htm</a>.
Текущую версию прошивки программатора и серийный номер можно увидеть,
выполнив команду <span style="font-weight: bold;">"Дополнительно -&gt;
Информация о плате"&nbsp; </span><span style="font-weight: bold;">
(Advanced -&gt; AS2M/AS3 Info)".<br>
  </span></p>
</ul>
<div style="text-align: center;"><img alt="asisp_version_info"
 src="asisp_version_info.jpg" style="width: 198px; height: 132px;"><br>
</div>
<ul>
  <p><span style="font-weight: bold;"></span>В некоторых случаях,
одновременно с заменой версии программы ASISP
нужно произвести обновление прошивки программатора. В теле программы
ASISP.exe содержится образ прошивки микроконтроллера ATmega8L, на
котором
построен AS2M/AS3. Таким образом, пользователь может произвести
операцию
обновления прошивки программатора самостоятельно. Эта процедура
производится выполнением команды <span style="font-weight: bold;">"Обновить
версию платы</span> <b>(Update firmware version)"</b> в меню <span
 style="font-weight: bold;">"Дополнительно (Advanced)"</span>. <br>
Для инициализации процедуры обновления прошивки следует выключить и
снова включить питание программатора.<br>
  </p>
  <p style="text-align: center;"><img alt="asisp_power_off_message"
 src="asisp_power_off_message.jpg" style="width: 641px; height: 127px;"><br>
  </p>
</ul>
<div style="text-align: center;">
<div style="text-align: left;">Во время выполнения процедуры обновления
прошивки необходимо, чтобы на
программатор было подано напряжение питания в диапазоне 3,3... 5,0
Вольт, например, от программируемой платы. Строка "AS2M/AS3 Bootloader"
свидетельствует о готовности программатора к обновлению прошивки.<br>
<br>
</div>
<img alt="asisp_bootloade" src="asisp_bootloader.jpg"
 style="width: 310px; height: 238px;"><br>
<br>
<div style="text-align: left;">На некоторых компьютерах (это связано с
особенностью реализации COM-портов на некоторых системных платах) нужно
выбрать опцию "Замедленная скорость".&nbsp; Если по каким-либо причинам
во время перепрограммирования был нарушен контакт в питании, или в
интерфейсе с компьютером, процедура обновления прервется с ошибкой. В
этом случае следует восстановить соединение и повторить процедуру до
успешного завершения. После завершения процесса программирования&nbsp;
программа выдаст соответствующее окно.<br>
<br>
<div style="text-align: center;"><img alt="asisp_version_ok_message"
 src="asisp_version_ok_message.jpg" style="width: 311px; height: 236px;"><br>
</div>
</div>
<br>
<br>
</div>
<ul>
  <div style="text-align: left;">Пожелания к программе ASISP и
предложения по ее улучшению можно
направлять по адресу: <a href="mailto:atmel@argussoft.ru">atmel@argussoft.ru</a>
  <br>
  </div>
</ul>
</body>
</html>
